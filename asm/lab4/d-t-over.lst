GAS LISTING d-t-over.S 			page 1


   1              	#    –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –¥–∏—Ä–µ–∫—Ç–∏–≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.
   2              	#    –ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è –¥–ª—è –∑–Ω–∞–∫–æ–≤–æ–≥–æ –∏ –±–µ–∑–∑–Ω–∞–∫–æ–≤–æ–≥–æ —Å–ª–æ–∂–µ–Ω–∏—
   3              	
   4              	#    –ê—Å—Å–µ–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–≤—è–∑–µ–π - –∫–æ–º–∞–Ω–¥–∞ m
   5              	
   6              	    .include "my-macro" # –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ —Å –º–∞–∫—Ä–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è–º–∏
   1              	/*
   2              	 * –ú–∞–∫—Ä–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã.
   3              	 * –ê—Ä–≥—É–º–µ–Ω—Ç—ã:
   4              	 *     - –∫–æ–¥ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã
   5              	 *
   6              	 * –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤–∞ –∏–∑–º–µ–Ω—è—é—Ç—Å—è —Ä–µ–≥–∏—Å—Ç—Ä—ã: %e
   7              	 * –°–º. —Ç–∞–∫–∂–µ 'man 2 exit'
   8              	*/
   9              	.macro Exit ret_val
  10              	    movl $1, %eax         # –Ω–æ–º–µ—Ä —Å–∏—Å—Ç. –≤—ã–∑–æ–≤–∞ exit
  11              	    movl \ret_val, %ebx     # –∫–æ–¥ –≤—ã—Ö–æ–¥–∞
  12              	    int $0x80         # –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤
  13              	.endm
  14              	
  15              	
  16              	/*
  17              	 * –ú–∞–∫—Ä–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–ª—è —Å—á–∏—Ç—ã–≤–∞–Ω–∏—è –æ–¥–Ω–æ–≥–æ –±–∞–π—Ç–∞ –∫–æ–¥–∞ —Å
  18              	 * —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –≤–≤–æ–¥–∞
  19              	 * –ê—Ä–≥—É–º–µ–Ω—Ç—ã:
  20              	 *     - –∞–¥—Ä–µ—Å –±—É—Ñ–µ—Ä–∞ –¥–ª—è —Å—á–∏—Ç—ã–≤–∞–Ω–∏—è –±–∞–π—Ç–∞
  21              	 * –†–µ–∑—É–ª—å—Ç–∞—Ç:
  22              	 *    - –≤ %eax –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—á–∏—Ç–∞–Ω–Ω—ã—Ö –±–∞–π—Ç–æ–≤
  23              	 *    - –ø–æ –∞–¥—Ä–µ—Å—É buf_addr - —Å—á–∏—Ç–∞–Ω–Ω—ã–π –±–∞–π—Ç
  24              	 *
  25              	 * –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤–∞ –∏–∑–º–µ–Ω—è—é—Ç—Å—è —Ä–µ–≥–∏—Å—Ç—Ä—ã: %e
  26              	 * –°–º. —Ç–∞–∫–∂–µ 'man 2 read'
  27              	*/
  28              	.macro Getchar buf_addr
  29              	    movl $3, %eax        # –Ω–æ–º–µ—Ä —Å–∏—Å—Ç. –≤—ã–∑–æ–≤–∞ read
  30              	    movl $0, %ebx        # –ø–∞—Ä–∞–º–µ—Ç—Ä 1: –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –≤–≤–æ
  31              	    movl \buf_addr, %ecx    # –ø–∞—Ä–∞–º–µ—Ç—Ä 2: –∞–¥—Ä–µ—Å –±—É—Ñ–µ—Ä–∞ (–æ–Ω –∂–µ - —Ñ–∞–∫—Ç–∏—á
  32              	                     # –ø–∞—Ä–∞–º–µ—Ç—Ä –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤–∞)
  33              	    movl $1, %edx        # –ø–∞—Ä–∞–º–µ—Ç—Ä 3: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–π—Ç–æ–≤ –¥–ª—è —á—Ç–µ–Ω–∏—
  34              	    int $0x80        # –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤
  35              	.endm
  36              	
  37              	/*
  38              	 * –ú–∞–∫—Ä–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–ª—è  –≤—ã–≤–æ–¥–∞ —Å—Ç—Ä–æ–∫–∏ –≤ —Ñ–∞–π–ª —Å—Ç–∞–Ω–¥–∞—Ä—Ç–
  39              	 * –ê—Ä–≥—É–º–µ–Ω—Ç—ã:
  40              	 *     - –°—Ç—Ä–æ–∫–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞.
  41              	 *
  42              	 * –ü—Ä–∏–º–µ—Ç—Ä –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤–∞:
  43              	 *    Puts "–¢–µ–∫—Å—Ç –≤—ã–≤–æ–¥–∏–º–æ–π —Å—Ç—Ä–æ–∫–∏"
  44              	 *
  45              	 * –†–µ–∑—É–ª—å—Ç–∞—Ç:
  46              	 *    - –≤—ã–≤–æ–¥–∏—Ç –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤—ã–≤–æ–¥ —Å–∏–º–≤–æ–ª—ã –∑–∞–¥–∞–Ω–Ω–æ–π —Å—Ç—Ä–
  47              	 *      –∏ –≤—Å–ª–µ–¥ –∑–∞ –Ω–∏–º–∏ —Å–∏–º–≤–æ–ª –ø–µ—Ä–µ–≤–æ–¥–∞ —Å—Ç—Ä–æ–∫–∏ \n
  48              	 *
  49              	 * –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∞–∫—Ä–æ–≤—ã–∑–æ–≤–∞ –∏–∑–º–µ–Ω—è—é—Ç—Å—è —Ä–µ–≥–∏—Å—Ç—Ä—ã: %e
  50              	 * –°–º. —Ç–∞–∫–∂–µ 'man puts', 'man 2 write'
  51              	*/
GAS LISTING d-t-over.S 			page 2


  52              	.macro Puts string
  53              	.data
  54              	    str\@:     .ascii "\string\n"  # —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä–æ–∫–∏ –
  55              	
  56              	    strlen\@ =     . - str\@           # –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª–∏–Ω—ã —Å—Ç—Ä–æ–∫–
  57              	
  58              	.text
  59              	    movl $4, %eax        # –Ω–æ–º–µ—Ä —Å–∏—Å—Ç. –≤—ã–∑–æ–≤–∞ write
  60              	    movl $1, %ebx        # –ø–∞—Ä–∞–º–µ—Ç—Ä 1: –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –≤—ã–≤
  61              	    movl $str\@, %ecx    # –ø–∞—Ä–∞–º–µ—Ç—Ä 2: –∞–¥—Ä–µ—Å –ø–∞–º—è—Ç–∏ —Å –≤—ã–≤–æ–¥–∏–º—ã–º–∏ —Å–∏
  62              	    movl $strlen\@, %edx     # –ø–∞—Ä–∞–º–µ—Ç—Ä 3: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–π—Ç–æ–≤ –¥–ª—è –≤—ã–≤–
  63              	    int $0x80        # –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π –≤—ã–∑–æ–≤
  64              	.endm
  65              	
  66              	.macro Finish
  67              	    movl $0, %ebx 	# first argument: exit code
  68              	    movl $1, %eax 	# sys_exit index
  69              	    int  $0x80 		# kernel interrupt
  70              	.endm
   7              	
   8              	.data # —Å–µ–∫—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏
   9              	
  10              	#                       –°–∏—Å—Ç–µ–º–∞ —Å—á–∏—Å–ª–µ–Ω–∏—è –æ–ø–µ—Ä–∞–Ω–¥–∞
  11              	
  12 0000 41       	Diff_bases: .byte  65   # 10
  13 0001 41       	    .byte  0101  # 8
  14 0002 21       	    .byte  041   # 8
  15 0003 41       	    .byte  0x41  # 16
  16 0004 41       	    .byte  0X41  # 16
  17              	
  18              	#    8      16     10
  19 0005 E5040000 	    .long  02345, 0x4E5, 1253
  19      E5040000 
  19      E5040000 
  20              	
  21              	#    –í—ã—Ä–∞–∂–µ–Ω–∏—è –≤ –¥–∏—Ä–µ–∫—Ç–∏–≤–∞—Ö
  22              	
  23              	Arifm_Expression:
  24              	
  25 0011 4141     	    .byte 35+30, 20+45
  26 0013 4141     	    .byte 70-5, 80-15
  27              	
  28 0015 61626320 	Str:    .ascii  "abc ABC 123"
  28      41424320 
  28      313233
  29 0020 D094D0B2 	Str1:   .ascii  "–î–≤–µ –∫–∞–ø–ª–∏ —Å–≤–µ—Ä–∫–Ω—É—Ç, —Å–≤–µ—Ä–∫–Ω—É—Ç"
  29      D0B520D0 
  29      BAD0B0D0 
  29      BFD0BBD0 
  29      B820D181 
  30 0054 D0BDD0B0 	Str2:   .asciz  "–Ω–∞ –¥–Ω–µ!"
  30      20D0B4D0 
  30      BDD0B521 
  30      00
  31              	
  32 0061 FF       	B1:        .byte   255
  33 0062 F0       	B2:        .byte   240
GAS LISTING d-t-over.S 			page 3


  34 0063 FF       	Bm1:       .byte   -1
  35 0064 01       	Bp1:       .byte   +1
  36 0065 80       	B_zn_min:  .byte   -128
  37 0066 7F       	B_zn_max:  .byte   +127
  38 0067 0F101F20 	BBB:       .byte   15,16,31,32,63,64
  38      3F40
  39 006d FF00     	S1:        .short  255
  40 006f F000     	S2:        .short  240
  41 0071 FFFF     	W_bzn_max: .short  65535
  42 0073 0080     	W_zn_min:  .short  -32768
  43 0075 FF7F     	W_zn_max:  .short  +32767
  44 0077 0F001000 	SSS:       .short  15,16,31,32,63,64
  44      1F002000 
  44      3F004000 
  45 0083 FFFFFFFF 	L1:        .long   4294967295
  46 0087 FFFFFFFF 	Il:        .int    4294967295
  47 008b 00000080 	I1:        .int    -2147483648
  48 008f FFFFFF7F 	I2:        .int    +2147483647
  49 0093 00000080 	Q:         .quad   -2147483648
  49      FFFFFFFF 
  50              	
  51              	.text # —Å–µ–∫—Ü–∏—è –∫–æ–º–∞–Ω–¥
  52              	
  53              	.global _start # —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞
  54              	
  55              	_start:
  56 0000 66A16D00 	    movw    S1, %ax    # —Å–ª–æ–≤–æ 255
  56      0000
  57 0006 6603056F 	    addw    S2, %ax    # + —Å–ª–æ–≤–æ 240 = 495
  57      000000
  58              	            # –ù–ï–¢ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è
  59              	
  60 000d 29C0     	    sub     %eax,%eax
  61 000f A0610000 	    movb    B1, %al    # –±–∞–π—Ç 255
  61      00
  62 0014 02056200 	    addb    B2, %al    # + 240
  62      0000
  63 001a 7202     	    jc      UnsignedOverflowb
  64 001c 90       	    nop
  65 001d 90       	    nop
  66              	
  67              	UnsignedOverflowb:
  68 001e 29C0     	    sub     %eax,%eax
  69 0020 66A17100 	    movw    W_bzn_max,%ax    # max –±–µ–∑–∑–Ω–∞–∫–æ–≤–æ–µ —Å–ª–æ–≤–æ
  69      0000
  70 0026 6683C001 	    addw    $1,%ax        # +1 –∫ –Ω–µ–º—É
  71 002a 7202     	    jc      UnsignedOverflow_w
  72 002c 90       	    nop
  73 002d 90       	    nop
  74              	
  75              	UnsignedOverflow_w:
  76 002e 29C0     	    sub     %eax,%eax
  77 0030 66A17500 	    movw    W_zn_max, %ax    # max –∑–Ω–∞–∫–æ–≤–æ–µ —Å–ª–æ–≤–æ
  77      0000
  78 0036 6683C001 	    addw    $1, %ax        # +1 –∫ –Ω–µ–º—É
  79 003a 7002     	    jo      SignedOverflow
  80 003c 90       	    nop
GAS LISTING d-t-over.S 			page 4


  81 003d 90       	    nop
  82              	
  83              	SignedOverflow:
  84 003e 29C0     	    sub     %eax, %eax
  85 0040 66A17300 	    movw    W_zn_min, %ax    # min –∑–Ω–∞–∫–æ–≤–æ–µ —Å–ª–æ–≤–æ
  85      0000
  86 0046 6683E801 	    subw    $1, %ax        # -1 –æ—Ç –Ω–µ–≥–æ
  87 004a 7002     	    jo      SignOver
  88 004c 90       	    nop
  89 004d 90       	    nop
  90              	
  91              	SignOver:
  92              	
  93              	    Finish # –∫–æ–Ω–µ—Ü —Ä–∞–±–æ—Ç—ã, –≤–æ–∑–≤—Ä–∞—Ç –≤ –û–° (–º–∞–∫—Ä–æ –∏–∑ —Ñ–∞–π–ª–∞ my-macro)
  93 004e BB000000 	>  movl $0,%ebx
  93      00
  93 0053 B8010000 	>  movl $1,%eax
  93      00
  93 0058 CD80     	>  int $0x80
  94              	    .end   # –ø–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç—Ä–æ–∫–∞ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
GAS LISTING d-t-over.S 			page 5


DEFINED SYMBOLS
          d-t-over.S:12     .data:00000000 Diff_bases
          d-t-over.S:23     .data:00000011 Arifm_Expression
          d-t-over.S:28     .data:00000015 Str
          d-t-over.S:29     .data:00000020 Str1
          d-t-over.S:30     .data:00000054 Str2
          d-t-over.S:32     .data:00000061 B1
          d-t-over.S:33     .data:00000062 B2
          d-t-over.S:34     .data:00000063 Bm1
          d-t-over.S:35     .data:00000064 Bp1
          d-t-over.S:36     .data:00000065 B_zn_min
          d-t-over.S:37     .data:00000066 B_zn_max
          d-t-over.S:38     .data:00000067 BBB
          d-t-over.S:39     .data:0000006d S1
          d-t-over.S:40     .data:0000006f S2
          d-t-over.S:41     .data:00000071 W_bzn_max
          d-t-over.S:42     .data:00000073 W_zn_min
          d-t-over.S:43     .data:00000075 W_zn_max
          d-t-over.S:44     .data:00000077 SSS
          d-t-over.S:45     .data:00000083 L1
          d-t-over.S:46     .data:00000087 Il
          d-t-over.S:47     .data:0000008b I1
          d-t-over.S:48     .data:0000008f I2
          d-t-over.S:49     .data:00000093 Q
          d-t-over.S:55     .text:00000000 _start
          d-t-over.S:67     .text:0000001e UnsignedOverflowb
          d-t-over.S:75     .text:0000002e UnsignedOverflow_w
          d-t-over.S:83     .text:0000003e SignedOverflow
          d-t-over.S:91     .text:0000004e SignOver

NO UNDEFINED SYMBOLS
